name: eks
shortDesc: Allows you to install any kubectl plugin
longDesc: |
  This plugin allows to manipulate the EKS Cluster on AWS

  This plugin requiere aws cli to be configured, for 'auto discovery' of
  the resources it will search for Subnets and Security groups with the 
  tags 

  kubernetes.io/cluster/cluster-name

  kubectl plugin eks create --cluster-name cluster-name
  kubectl plugin eks list
  kubectl plugin eks describe --cluster-name cluster-name
  kubectl plugin eks create --cluster-name cluster-name
  kubectl plugin eks showconfig


example: kubectl plugin eks-cluster --help

command: ./eks.sh

tree:
  - name: create
    shortDesc: create
    command: ./eks-create.sh
    flags:
      - name: region
        desc: the region where to operate
        defValue: us-west-2
      - name: cluster-name
        desc: name of the cluster
      - name: subnet-ids
        desc: space separated list of subnet ids
      - name: security-group-ids
        desc: space separated list of security group ids
      - name: service-role-arn
        desc: arn of the service role
  - name: delete
    shortDesc: delete
    command: ./eks-delete.sh
    flags:
      - name: region
        desc: the region where to operate
      - name: cluster-name
        desc: the region where to operate
      - name: im-insane
        desc: are you sure you want to run this???
  - name: list
    shortDesc: list
    command: ./eks-list.sh
    flags:
      - name: region
        desc: the region where to operate
        defValue: us-west-2
  - name: describe
    shortDesc: describe
    command: ./eks-describe.sh
    flags:
      - name: region
        desc: the region where to operate
        defValue: us-west-2
      - name: cluster-name
        desc: name of the cluster
        defValue: demo
      - name: detail
        desc: produce more detailed output
        defValue: "no"
  - name: genconf
    shortDesc: show configuration file
    command: ./eks-genconf.sh
    flags:
      - name: region
        desc: the region where to operate
        defValue: us-west-2
      - name: cluster-name
        desc: name of the cluster
        defValue: demo
  - name: nodes
    shortDesc: List Public Ip Of Internal Nodes
    command: ./eks-getnodes.sh
    flags:
      - name: region
        desc: the region
        defValue: us-west-2
  - name: asg
    shortDesc: display and modify the autoscaling group
    command: ./eks-asg.sh
    longDesc: |
      kubectl plugin eks asg allows you to modify the autoscaling group
      associated with the EKS cluster.

      This will try to autodiscover the ASG by looking at 
      the kubernetes.io/cluster/cluster-name tag on the autoscaling group.
      
      if more than 1 asg is returned, you must specify the asg with 
      the asg-name option
    flags:
      - name: region
        desc: the region where to operate
        defValue: us-west-2
      - name: cluster-name
        desc: name of the cluster
        defValue: demo
      - name: asg-name
        desc: name of the autoscaling group
      - name: min
        desc: min instances
      - name: max
        desc: max instances
      - name: desired
        desc: desired number of instances
